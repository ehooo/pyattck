from .attckobject import AttckObject


class AttckMalware(AttckObject):
    """A child class of AttckObject
       Creates objects which have been categorized as malware used in attacks
    
    Arguments:
        AttckObject (dict) -- Takes the Mitre ATT&CK Json object as a kwargs values
    """

    def __init__(self, **kwargs):
        """Creates an AttckMalware object.  
           The AttckMalware object is based on malware which have been categorized as software used in attacks
        """
        super(AttckMalware, self).__init__(**kwargs)

        self.created_by_ref = self._get_attribute('created_by_ref')
        self.aliases = self._get_list_items('x_mitre_aliases')
        self.platforms = self._get_list_items('x_mitre_platforms')
        self.labels = self._get_list_items('labels')
        self.external_references = self.reference
        self.revoked = self._get_attribute('revoked')
        self._techniques = set()
        self._actors = set()

    def put_actors(self, actor):
        self._actors.add(actor)

    def get_actors(self):
        '''Returns all actor objects as a generator that are documented as using this malware'''
        for actor in self._actors:
            yield actor

    @property
    def actors(self):
        '''Returns all actor objects as a list that are documented as using this malware'''
        return list(self._actors)

    def put_techniques(self, technique):
        self._techniques.add(technique)

    def get_techniques(self):
        '''Returns all technique objects as a generator that are documented as using this malware'''
        for technique in self._techniques:
            yield technique

    @property
    def techniques(self):
        '''Returns all technique objects as a list that are documented as using this malware'''
        return list(self._techniques)
